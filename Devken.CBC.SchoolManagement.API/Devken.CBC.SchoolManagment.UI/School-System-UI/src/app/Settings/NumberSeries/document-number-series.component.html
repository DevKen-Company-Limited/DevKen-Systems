<div class="absolute inset-0 flex min-w-0 flex-col overflow-y-auto" cdkScrollable>

  <!-- Page Header -->
  <app-page-header
    title="Document Number Series"
    description="Configure automatic number generation for different entity types"
    icon="pin"
    [breadcrumbs]="breadcrumbs"
    [actionTemplate]="headerActions">
  </app-page-header>

  <!-- Header Actions Template -->
  <ng-template #headerActions>
    <button mat-flat-button 
      class="bg-white text-indigo-700 hover:bg-yellow-200 hover:text-indigo-900 shadow-lg transition-all hover:shadow-xl font-bold" 
      (click)="openCreate()">
      <mat-icon class="icon-size-5">add</mat-icon>
      <span class="ml-2">Add Series</span>
    </button>
  </ng-template>

  <!-- Main Content -->
  <div class="bg-card -mt-10 flex-auto rounded-t-2xl p-6 shadow sm:p-10">

    <!-- Stats Cards -->
    <app-stats-cards [cards]="statsCards" [columns]="4"></app-stats-cards>

    <!-- Data Table -->
    <app-data-table
      [columns]="tableColumns"
      [data]="paginatedData"
      [actions]="tableActions"
      [loading]="isLoading"
      [header]="tableHeader"
      [emptyState]="tableEmptyState"
      [cellTemplates]="cellTemplates">
    </app-data-table>

    <!-- Pagination -->
    <app-pagination
      *ngIf="!isLoading"
      [currentPage]="currentPage"
      [totalItems]="filteredData.length"
      [itemsPerPage]="itemsPerPage"
      [itemLabel]="'number series'"
      [showItemsPerPageSelector]="true"
      [showPageNumbers]="true"
      (pageChange)="onPageChange($event)"
      (itemsPerPageChange)="onItemsPerPageChange($event)">
    </app-pagination>
  </div>
</div>

<!-- Cell Templates -->
<ng-template #entityCell let-row>
  <div class="flex items-center gap-2">
    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-100 to-violet-100 dark:from-indigo-900 dark:to-violet-900 flex items-center justify-center">
      <mat-icon class="text-indigo-600 dark:text-indigo-400 icon-size-4">{{ getEntityIcon(row.entityName) }}</mat-icon>
    </div>
    <span class="text-sm font-semibold text-gray-900 dark:text-white">{{ row.entityName }}</span>
  </div>
</ng-template>

<ng-template #formatCell let-row>
  <span class="inline-flex items-center gap-1 px-3 py-1 rounded-lg text-sm font-mono font-bold bg-indigo-50 dark:bg-indigo-900/30 text-indigo-700 dark:text-indigo-300 border border-indigo-200 dark:border-indigo-800">
    {{ getFormatPreview(row) }}
  </span>
</ng-template>

<ng-template #statusCell let-row>
  <div class="flex items-center gap-2">
    <span class="text-sm text-gray-700 dark:text-gray-300">
      Last: <span class="font-bold">{{ row.lastNumber }}</span>
    </span>
    <span *ngIf="row.resetEveryYear" 
          class="inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-semibold bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300">
      <mat-icon class="icon-size-3">autorenew</mat-icon>
      Yearly Reset
    </span>
  </div>
</ng-template>